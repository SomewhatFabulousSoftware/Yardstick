url: https://helpx.adobe.com/media-encoder/release-notes.html
urlredirects: false
preDownloadScript: |
  using module .\Modules\Custom\AdobeDownloader.psm1
  $Script:MediaEncoder = [AdobeApplication]::new(@{
    Name = "Media Encoder"
    ID = "MediaEncoder"
    URL = $URL
    VersionMatchStringRegex = "[A-Za-z]{3,10} [0-9]{4} release \(version [0-9]{1,}\.[0-9]{1,}"
    VersionLocation = -1
    PackageName = "Auto_MediaEncoder_<Version>_NU_NAU"
  })

  $Script:MediaEncoder.Update()
  $Version = $MediaEncoder.Version
  $VersionYear = $MediaEncoder.VersionYear
  $PackageName = $MediaEncoder.PackageName
  $InstallScript = $MediaEncoder.InstallScript
  $UninstallScript = $MediaEncoder.UninstallScript
downloadScript: |
  $Script:MediaEncoder.Download()
filename: setup.exe
iconFile: MediaEncoder.png
id: MediaEncoder
displayName: Adobe Media Encoder
publisher: Adobe
description: Ingest, transcode, create proxies, and output to almost any format you can imagine. Automate your workflows with presets, Watch Folders, and Destination Publishing. Use Time Tuner to invisibly adjust duration, and apply LUTs and Loudness corrections without having to re-open projects. Tight integration with Adobe Premiere Pro, After Effects, and other applications provides a seamless workflow.
detectionType: script
detectionScript: |
  $NewestVersionPath = ((Get-ChildItem "C:\Program Files\Adobe\Adobe Media Encoder*" | Sort-Object Name -Descending)[0]).FullName
  $InstalledFileName = "Adobe Media Encoder.exe"
  if (Test-Path "$NewestVersionPath\$InstalledFileName") {
    Write-Host "Product has installed correctly"
    exit 0
  }
  Write-Host "Product has failed to install correctly"
  exit 1
installExperience: system
restartBehavior: suppress
minOSVersion: W10_20H2