url: 'https://helpx.adobe.com/after-effects/release-note/release-notes-after-effects.html'
urlredirects: false
preDownloadScript: |
  using module .\Modules\Custom\AdobeDownloader.psm1
  $Script:AfterEffects = [AdobeApplication]::new(@{
    Name = "After Effects"
    ID = "AfterEffects"
    URL = $URL
    VersionMatchStringRegex = "(?<=\()[0-9]{1,}\.[0-9]{1,}"
    VersionLocation = 0
    PackageName = "Auto_AfterEffects_<Version>_NU_NAU"
  })

  $Script:AfterEffects.Update()
  $Version = $AfterEffects.Version
  $VersionYear = $AfterEffects.VersionYear
  $PackageName = $AfterEffects.PackageName
  $InstallScript = $AfterEffects.InstallScript
  $UninstallScript = $AfterEffects.UninstallScript
downloadScript: |
  $Script:AfterEffects.Download()
filename: setup.exe
iconFile: AfterEffects.png
id: AfterEffects
displayName: Adobe After Effects
publisher: Adobe
description: Adobe After Effects is a digital visual effects, motion graphics, and compositing application developed by Adobe; it is used in the post-production process of film making, video games and television production. Among other things, After Effects can be used for keying, tracking, compositing, and animation.
detectionType: script
detectionScript: |
  $NewestVersionPath = ((Get-ChildItem "C:\Program Files\Adobe\Adobe After Effects*" | Sort-Object Name -Descending)[0]).FullName
  $InstalledFileName = "AfterFX.exe"
  if (Test-Path "$NewestVersionPath\Support Files\$InstalledFileName") {
    Write-Host "Product has installed correctly"
    exit 0
  }
  Write-Host "Product has failed to install correctly"
  exit 1
installExperience: system
restartBehavior: suppress
minOSVersion: W10_20H2
