url: https://helpx.adobe.com/indesign/release-notes.html
urlredirects: false
preDownloadScript: |
  $content = Invoke-WebRequest $url
  $content.content -match "InDesign version [0-9]{1,}\.[0-9]{1,} release \([A-Za-z]{3,} [0-9]{4}\)" | Out-Null
  $versionString = $matches[0]
  $versionYear = $versionString.split(" ")[-1].trim(")")
  $Script:version = $versionString.split(" ")[2]
  $Script:PackageName = "Auto_InDesign_$($version)_NU_NoAutoUpdate"
  $Script:uninstallScript = "msiexec /x $PackageName.msi /qn /norestart"
  $Script:fileDetectionPath = "%ProgramFiles%\Adobe\Adobe InDesign $versionYear"
downloadScript: |
  Start-AdobeDownload -SearchNames "InDesign"
installScript: |
  setup.exe --silent --ADOBEINSTALLDIR="%ProgramFiles%\Adobe" --INSTALLLANGUAGE=en_US
filename: setup.exe
iconFile: InDesign.png
id: InDesign
displayName: Adobe InDesign
publisher: Adobe
description: Adobe InDesign is a desktop publishing and page layout designing software application.
detectionType: file
fileDetectionName: InDesign.exe
fileDetectionMethod: exists
installExperience: system
restartBehavior: suppress
minOSVersion: W10_20H2
